import datetime
import json
import sys
from create_docx import Asset, create_single_asset_docx, create_user_assets_docx

example_json = '{"id":174,"name":"","asset_tag":"00174","serial":"GFSKJG3","model":{"id":7,"name":"Latitude 5520"},"byod":false,"model_number":null,"eol":null,"asset_eol_date":null,"status_label":{"id":2,"name":"Ready to Deploy","status_type":"deployable","status_meta":"deployed"},"category":{"id":3,"name":"Laptop"},"manufacturer":{"id":3,"name":"Dell"},"supplier":null,"notes":null,"order_number":null,"company":{"id":1,"name":"Belek"},"location":{"id":1,"name":"Kullanıcılar"},"rtd_location":null,"image":null,"qr":null,"alt_barcode":"https://demirbas.megasaray.local/uploads/barcodes/c128-00174.png","assigned_to":{"id":2,"username":"o.akin","name":"Onur Akin","first_name":"Onur","last_name":"Akin","email":"o.akin@megasarayhotels.com","employee_number":null,"type":"user"},"warranty_months":null,"warranty_expires":null,"created_at":{"datetime":"2023-09-04 12:33:06","formatted":"2023-09-04 12:33 PM"},"updated_at":{"datetime":"2023-09-04 12:33:06","formatted":"2023-09-04 12:33 PM"},"last_audit_date":null,"next_audit_date":null,"deleted_at":null,"purchase_date":null,"age":"","last_checkout":{"datetime":"2023-09-04 12:33:06","formatted":"2023-09-04 12:33 PM"},"expected_checkin":null,"purchase_cost":null,"checkin_counter":0,"checkout_counter":1,"requests_counter":0,"user_can_checkout":false,"book_value":null,"custom_fields":{},"available_actions":{"checkout":true,"checkin":true,"clone":true,"restore":false,"update":true,"delete":false}}'
example_user_json = '{"total":4,"rows":[{"id":27,"name":"","asset_tag":"00027","serial":"CN02VNH80WSL001BAJJGBA04","model":{"id":20,"name":"S2721HS"},"byod":false,"model_number":null,"eol":null,"asset_eol_date":null,"status_label":{"id":2,"name":"Ready to Deploy","status_type":"deployable","status_meta":"deployable"},"category":{"id":2,"name":"Monitör"},"manufacturer":{"id":3,"name":"Dell"},"supplier":null,"notes":null,"order_number":null,"company":{"id":1,"name":"Belek"},"location":{"id":1,"name":"Kullanıcılar"},"rtd_location":null,"image":null,"qr":null,"alt_barcode":"https://demirbas.megasaray.local/uploads/barcodes/c128-00027.png","assigned_to":null,"warranty_months":null,"warranty_expires":null,"created_at":{"datetime":"2023-08-31 09:25:31","formatted":"2023-08-31 09:25 AM"},"updated_at":{"datetime":"2023-08-31 09:25:31","formatted":"2023-08-31 09:25 AM"},"last_audit_date":null,"next_audit_date":null,"deleted_at":null,"purchase_date":null,"age":"","last_checkout":{"datetime":"2023-08-31 09:25:31","formatted":"2023-08-31 09:25 AM"},"expected_checkin":null,"purchase_cost":null,"checkin_counter":0,"checkout_counter":1,"requests_counter":0,"user_can_checkout":false,"book_value":null,"custom_fields":{},"available_actions":{"checkout":true,"checkin":true,"clone":true,"restore":false,"update":true,"delete":false}},{"id":28,"name":"","asset_tag":"00028","serial":"D1304W3","model":{"id":18,"name":"Vostro 3510"},"byod":false,"model_number":null,"eol":null,"asset_eol_date":null,"status_label":{"id":2,"name":"Ready to Deploy","status_type":"deployable","status_meta":"deployable"},"category":{"id":3,"name":"Laptop"},"manufacturer":{"id":3,"name":"Dell"},"supplier":null,"notes":null,"order_number":null,"company":{"id":1,"name":"Belek"},"location":{"id":1,"name":"Kullanıcılar"},"rtd_location":null,"image":null,"qr":null,"alt_barcode":"https://demirbas.megasaray.local/uploads/barcodes/c128-00028.png","assigned_to":null,"warranty_months":null,"warranty_expires":null,"created_at":{"datetime":"2023-08-31 09:27:05","formatted":"2023-08-31 09:27 AM"},"updated_at":{"datetime":"2023-08-31 09:27:05","formatted":"2023-08-31 09:27 AM"},"last_audit_date":null,"next_audit_date":null,"deleted_at":null,"purchase_date":null,"age":"","last_checkout":{"datetime":"2023-08-31 09:27:05","formatted":"2023-08-31 09:27 AM"},"expected_checkin":null,"purchase_cost":null,"checkin_counter":0,"checkout_counter":1,"requests_counter":0,"user_can_checkout":false,"book_value":null,"custom_fields":{},"available_actions":{"checkout":true,"checkin":true,"clone":true,"restore":false,"update":true,"delete":false}},{"id":29,"name":"","asset_tag":"00029","serial":"VNFNF02564","model":{"id":21,"name":"LaserJet Pro MFP M130fw"},"byod":false,"model_number":null,"eol":null,"asset_eol_date":null,"status_label":{"id":2,"name":"Ready to Deploy","status_type":"deployable","status_meta":"deployable"},"category":{"id":6,"name":"Yazıcı"},"manufacturer":{"id":2,"name":"Hewlett-Packard"},"supplier":null,"notes":null,"order_number":null,"company":{"id":1,"name":"Belek"},"location":{"id":1,"name":"Kullanıcılar"},"rtd_location":null,"image":null,"qr":null,"alt_barcode":"https://demirbas.megasaray.local/uploads/barcodes/c128-00029.png","assigned_to":null,"warranty_months":null,"warranty_expires":null,"created_at":{"datetime":"2023-08-31 09:28:21","formatted":"2023-08-31 09:28 AM"},"updated_at":{"datetime":"2023-08-31 09:28:21","formatted":"2023-08-31 09:28 AM"},"last_audit_date":null,"next_audit_date":null,"deleted_at":null,"purchase_date":null,"age":"","last_checkout":{"datetime":"2023-08-31 09:28:21","formatted":"2023-08-31 09:28 AM"},"expected_checkin":null,"purchase_cost":null,"checkin_counter":0,"checkout_counter":1,"requests_counter":0,"user_can_checkout":false,"book_value":null,"custom_fields":{},"available_actions":{"checkout":true,"checkin":true,"clone":true,"restore":false,"update":true,"delete":false}},{"id":30,"name":"","asset_tag":"00030","serial":"T1797804956","model":{"id":4,"name":"GM21 Pro"},"byod":false,"model_number":null,"eol":null,"asset_eol_date":null,"status_label":{"id":2,"name":"Ready to Deploy","status_type":"deployable","status_meta":"deployable"},"category":{"id":4,"name":"Akıllı Telefon"},"manufacturer":{"id":4,"name":"General Mobile"},"supplier":null,"notes":null,"order_number":null,"company":{"id":1,"name":"Belek"},"location":{"id":1,"name":"Kullanıcılar"},"rtd_location":null,"image":null,"qr":null,"alt_barcode":"https://demirbas.megasaray.local/uploads/barcodes/c128-00030.png","assigned_to":null,"warranty_months":null,"warranty_expires":null,"created_at":{"datetime":"2023-08-31 09:29:11","formatted":"2023-08-31 09:29 AM"},"updated_at":{"datetime":"2023-08-31 09:29:11","formatted":"2023-08-31 09:29 AM"},"last_audit_date":null,"next_audit_date":null,"deleted_at":null,"purchase_date":null,"age":"","last_checkout":{"datetime":"2023-08-31 09:29:11","formatted":"2023-08-31 09:29 AM"},"expected_checkin":null,"purchase_cost":null,"checkin_counter":0,"checkout_counter":1,"requests_counter":0,"user_can_checkout":false,"book_value":null,"custom_fields":{},"available_actions":{"checkout":true,"checkin":true,"clone":true,"restore":false,"update":true,"delete":false}}]}'

def handle_json(jsonObj: str):
    current_object = json.loads(jsonObj)
    # kullanici assetleri
    if (current_object.get('total') != None):
        assets = []
        json_array = current_object.get('rows')
        for asset in json_array:
            assets.append(Asset(asset))
        create_user_assets_docx(assets)
    # tek asset
    else:
        current_asset = Asset(current_object)
        create_single_asset_docx(current_asset)

handle_json(sys.argv[1])
# handle_json(example_json)
# handle_json(example_user_json)
